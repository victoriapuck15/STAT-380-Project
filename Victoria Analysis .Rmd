---
title: "STAT 380 Project"
author: "Victoria Puck-Karam"
date: "2023-11-22"
output: html_document
---
```{r}
install.packages("cluster")
library(cluster)
```


```{r}
library(readr)
dataset <- read_csv("/Users/victoriapuck-karam/Downloads/dataset.csv")
dataset
```
```{r}

column_data <- dataset$track_genre

value_counts <- table(column_data)

print(value_counts)
```

```{r}
selected_columns <- c(
  "popularity", "duration_ms", "danceability", "energy",
  "loudness", "speechiness", "acousticness", "instrumentalness",
  "liveness", "valence", "tempo"
)

new_dataset <- dataset[, selected_columns]
new_dataset
```

```{r}
pca_result <- prcomp(newdata, center = TRUE, scale. = TRUE)
summary(pca_result)
```
```{r}
pve <- get_eig(pca_result)
pve
```
```{r}
cor_matrix <- cor(newdata[, c("popularity",  "danceability", "energy","loudness","speechiness", "acousticness", "instrumentalness", "liveness","valence","tempo" )])

print(cor_matrix)
```
```{r}
newdata
```

```{r}
scaled_data <- scale(newdata)
scaled_data
```

```{r}
k <- 5
kmeans_result <- kmeans(scaled_data, centers = k)
newdata$cluster <- kmeans_result$cluster

print(kmeans_result$centers)

plot(newdata[, c("popularity", "loudness")], col = kmeans_result$cluster, main = "K-means Clustering")
points(kmeans_result$centers[, c("popularity", "loudness")], col = 1:k, pch = 8, cex = 4)
```
```{r}
# Perform k-means clustering
kmeans_result <- kmeans(scaled_data, centers = k)

# Extract cluster assignments
cluster_assignments <- kmeans_result$cluster

# Create a data frame with cluster assignments and scaled data
clustered_data <- data.frame(Cluster = factor(cluster_assignments), scaled_data)

# Calculate the mean for each variable within each cluster
cluster_means <- aggregate(. ~ Cluster, data = clustered_data, mean)

# Reorder the data frame columns
cluster_means <- cluster_means[, c(1, order(names(cluster_means)[-1]) + 1)]

# Plot a heatmap
heatmap(as.matrix(cluster_means[, -1]), 
        Rowv = NA, Colv = NA, 
        col = cm.colors(256),
        main = "Cluster Means",
        xlab = "Variables", ylab = "Clusters")
```
```{r}
set.seed(123)  # Set a seed for reproducibility
sample_indices <- sample(nrow(newdata), size = 100)  # Adjust the size as needed
subset_data <- newdata[sample_indices, ]
```


```{r}

distances <- dist(subset_data)

hclust_result <- hclust(distances, method = "complete")


plot(hclust_result, main = "Hierarchical Clustering Dendrogram",
     xlab = "Observations", sub = NULL)


rect.hclust(hclust_result, k = 5, border = 2:5)
```
```{r}
selected_columns <- c("loudness", "popularity")
numeric_data <- newdata[, selected_columns]

# Standardize the data (optional but recommended for k-means)
scaled_data <- scale(numeric_data)


k <- 5

# Perform k-means clustering
kmeans_result <- kmeans(scaled_data, centers = k)

# Add cluster assignments to the original dataset
newdata$cluster <- kmeans_result$cluster

# Visualize the clusters
plot(newdata$loudness, newdata$popularity, col = kmeans_result$cluster, pch = 16, main = "K-means Clustering")
points(kmeans_result$centers[, 1], kmeans_result$centers[, 2], col = 1:k, pch = 8, cex = 2)
legend("topright", legend = 1:k, col = 1:k, pch = 16, title = "Cluster")
```
```{r}
temp<- dataset%>%filter(track_genre=="pop")
temp
```
```{r}
selected_columns <- c(
  "popularity", "duration_ms", "danceability", "energy",
  "loudness", "speechiness", "acousticness", "instrumentalness",
  "liveness", "valence", "tempo"
)

popsongs <- temp[, selected_columns]
popsongs
```

```{r}
selected_columns <- c("danceability", "popularity")
numeric_data <- popsongs[, selected_columns]

# Standardize the data (optional but recommended for k-means)
scaled_data <- scale(popsongs)


k <- 3

# Perform k-means clustering
kmeans_result <- kmeans(scaled_data, centers = k)

# Add cluster assignments to the original dataset
popsongs$cluster <- kmeans_result$cluster

# Visualize the clusters
plot(popsongs$danceability, popsongs$popularity, col = kmeans_result$cluster, pch = 16, main = "K-means Clustering")
points(kmeans_result$centers[, 1], kmeans_result$centers[, 2], col = 1:k, pch = 8, cex = 2)
legend("topright", legend = 1:k, col = 1:k, pch = 16, title = "Cluster")
```
```{r}
column_data <- dataset$popularity

value_counts <- table(column_data)

print(value_counts)
```

```{r}
best<- newdata%>%filter(popularity>70)
best
```
```{r}
selected_columns <- c(
  "popularity", "duration_ms", "danceability", "energy",
  "loudness", "speechiness", "acousticness", "instrumentalness",
  "liveness", "valence", "tempo"
)

mostpop <- best[, selected_columns]
mostpop
```
```{r}
selected_columns <- c("danceability", "popularity")
numeric_data <- mostpop[, selected_columns]

# Standardize the data (optional but recommended for k-means)
scaled_data <- scale(mostpop)


k <- 3

# Perform k-means clustering
kmeans_result <- kmeans(scaled_data, centers = k)

# Add cluster assignments to the original dataset
mostpop$cluster <- kmeans_result$cluster

# Visualize the clusters
plot(mostpop$danceability, mostpop$popularity, col = kmeans_result$cluster, pch = 16, main = "K-means Clustering")
points(kmeans_result$centers[, 1], kmeans_result$centers[, 2], col = 1:k, pch = 8, cex = 2)
legend("topright", legend = 1:k, col = 1:k, pch = 16, title = "Cluster")
```

